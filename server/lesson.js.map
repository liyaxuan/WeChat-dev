{"version":3,"sources":["lesson.es6.js"],"names":[],"mappings":";;;;;;;AAAA;;AAEA,IAAI,SAAS;AACZ,SAAQ,gBAAC,GAAD,EAAM,GAAN,EAAc;AACrB,oBAAM;AACL,QAAK,QAAL;AACA,WAAQ,MAAR;GAFD,EAGG,IAHH,CAGQ,UAAC,KAAD,EAAW;AAClB,SAAM,OAAN,CAAc,UAAC,IAAD,EAAU;AACvB,SAAK,KAAL,CAAW,OAAX,CAAmB,UAAC,IAAD,EAAU;AAC5B,YAAO,KAAK,OAAL,CADqB;KAAV,CAAnB,CADuB;IAAV,CAAd,CADkB;AAMlB,OAAG,MAAM,MAAN,IAAgB,CAAhB,EACF,IAAI,IAAJ,CAAS,EAAE,QAAQ,SAAR,EAAmB,MAAM,KAAN,EAA9B,EADD,KAGC,IAAI,IAAJ,CAAS,EAAE,QAAQ,MAAR,EAAgB,MAAM,KAAN,EAA3B,EAHD;GANO,EAUL,4BAAgB,GAAhB,CAbH,EADqB;EAAd;;AAiBR,UAAS,iBAAC,GAAD,EAAM,GAAN,EAAc,EAAd;;AAIT,YAAW,mBAAC,GAAD,EAAM,GAAN,EAAc;AACxB,MAAI,OAAO,IAAI,KAAJ,CAAU,IAAV,CADa;AAExB,MAAI,SAAS,IAAI,KAAJ,CAAU,MAAV,CAFW;AAGxB,MAAI,MAAM,IAAI,KAAJ,CAAU,GAAV,CAHc;AAIxB,oBAAM;AACL,QAAK,QAAL;AACA,WAAQ,QAAR;AACA,cAAW;AACV,UAAM,IAAN;AACA,oBAAgB,MAAhB;AACA,iBAAa,EAAb;IAHD;AAKA,eAAY,EAAE,aAAa,GAAb,EAAd;GARD,EASG,IATH,CASQ,UAAC,GAAD,EAAS;AAChB,OAAI,SAAS,IAAI,MAAJ,CADG;AAEhB,WAAQ,GAAR,CAAY,MAAZ,EAFgB;AAGhB,OAAG,OAAO,CAAP,IAAY,CAAZ,EACF,IAAI,IAAJ,CAAS,EAAE,QAAQ,SAAR,EAAX,EADD,KAGC,IAAI,IAAJ,CAAS,EAAE,QAAQ,MAAR,EAAgB,MAAM,MAAN,EAA3B,EAHD;GAHO,EAOL,UAAC,GAAD,EAAS;AACX,OAAI,IAAJ,CAAS,EAAE,QAAQ,MAAR,EAAgB,MAAM,GAAN,EAA3B,EADW;GAAT,CAhBH,CAJwB;EAAd;;AAyBX,YAAW,mBAAC,GAAD,EAAM,GAAN,EAAc;AACxB,MAAI,OAAO,IAAI,KAAJ,CAAU,IAAV,CADa;AAExB,MAAI,SAAS,IAAI,KAAJ,CAAU,MAAV,CAFW;;AAIxB,oBAAM;AACL,QAAK,QAAL;AACA,WAAQ,QAAR;AACA,cAAW;AACV,UAAM,IAAN;AACA,oBAAgB,MAAhB;IAFD;GAHD,EAOG,IAPH,CAOQ,UAAC,GAAD,EAAS;AAChB,OAAI,SAAS,IAAI,MAAJ,CADG;AAEhB,WAAQ,GAAR,CAAY,MAAZ,EAFgB;AAGhB,OAAG,OAAO,CAAP,IAAY,CAAZ,EACF,IAAI,IAAJ,CAAS,EAAE,QAAQ,SAAR,EAAX,EADD,KAGC,IAAI,IAAJ,CAAS,EAAE,QAAQ,MAAR,EAAX,EAHD;GAHO,EAOL,4BAAgB,GAAhB,CAdH,EAJwB;EAAd;CA/CR;;QAqEK","file":"lesson.js","sourcesContent":["import { mongo, mongoErrHandler } from './mongo';\r\n\r\nlet lesson = {\r\n\tgetAll: (req, res) => {\r\n\t\tmongo({\r\n\t\t\tcol: 'lesson',\r\n\t\t\tmethod: 'find'\r\n\t\t}).then((array) => {\r\n\t\t\tarray.forEach((item) => {\r\n\t\t\t\titem.teach.forEach((item) => {\r\n\t\t\t\t\tdelete item.student;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tif(array.length != 0)\r\n\t\t\t\tres.json({ result: 'success', data: array });\r\n\t\t\telse\r\n\t\t\t\tres.json({ result: 'fail', data: array });\r\n\t\t}, mongoErrHandler(res));\r\n\t},\r\n\t/*管理员新增一个教学班*/\r\n\tpostOne: (req, res) => {\r\n\r\n\t},\r\n\t/*教师选择一个教学班*/\r\n\tselectOne: (req, res) => {\r\n\t\tlet name = req.query.name;\r\n\t\tlet numero = req.query.numero;\t\r\n\t\tlet tid = req.query.tid;\r\n\t\tmongo({\r\n\t\t\tcol: 'lesson',\r\n\t\t\tmethod: 'update',\r\n\t\t\tqueryData: {\r\n\t\t\t\tname: name,\r\n\t\t\t\t'teach.numero': numero,\r\n\t\t\t\t'teach.tid': ''\r\n\t\t\t},\r\n\t\t\tupdateData: { 'teach.tid': tid }\r\n\t\t}).then((doc) => {\r\n\t\t\tlet result = doc.result;\r\n\t\t\tconsole.log(result);\r\n\t\t\tif(result.n >= 1)\r\n\t\t\t\tres.json({ result: 'success' });\r\n\t\t\telse\r\n\t\t\t\tres.json({ result: 'fail', code: result })\r\n\t\t}, (err) => {\r\n\t\t\tres.json({ result: 'fail', code: err });\r\n\t\t});\r\n\t},\r\n\t/*管理员删除一个教学班*/\r\n\tdeleteOne: (req, res) => {\r\n\t\tlet name = req.query.name;\r\n\t\tlet numero = req.query.numero;\r\n\r\n\t\tmongo({\r\n\t\t\tcol: 'lesson',\r\n\t\t\tmethod: 'remove',\r\n\t\t\tqueryData: {\r\n\t\t\t\tname: name,\r\n\t\t\t\t'teach.numero': numero\r\n\t\t\t}\r\n\t\t}).then((doc) => {\r\n\t\t\tlet result = doc.result;\r\n\t\t\tconsole.log(result);\r\n\t\t\tif(result.n >= 1)\r\n\t\t\t\tres.json({ result: 'success' });\r\n\t\t\telse\r\n\t\t\t\tres.json({ result: 'fail' });\r\n\t\t}, mongoErrHandler(res));\r\n\t}\r\n};\r\n\r\nexport { lesson };"],"sourceRoot":"/source/"}